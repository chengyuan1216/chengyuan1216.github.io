<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" href="../index.css">
    <script src="../index.js"></script>
    <script src="../babel.js"></script>
    <script>

    </script>
</head>
<body >

<div class="box">
    <h3>什么是Proxy</h3>
    <p>
        可以通过Proxy对象来代理某个对象，当需要操作或访问这个对象时需要通过Proxy对象来完成。
        通过proxy的第二个参数配置，当具体对Proxy访问时所进行的行为，比如get。
    </p>
    <p>
        Proxy 可以理解成，在目标对象之前架设一层“拦截”，外界对该对象的操作访问，都必须先通过这层拦截，因此提供了一种机制，可以对外界的访问进行过滤和改写。Proxy 这个词的原意是代理，用在这里表示由它来“代理”某些操作，可以译为“代理器”。
    </p>
    <p>
        下面是一个拦截读取属性行为的例子。
    </p>
    <pre>
        var proxy = new Proxy({}, {
            get: function(target, property) {
                return 35;
            }//get其中的一种，共有13中拦截的方式。<a href="http://es6.ruanyifeng.com/#docs/proxy">点击查看</a>
        });

        console.log(proxy.time )// 35
        console.log(proxy.name) // 35
        console.log(proxy.title) // 35
    </pre>
    <p>
        Proxy作为构造函数，Proxy接受两个参数。第一个参数是所要代理的目标对象（上例是一个空对象），即如果没有Proxy的介入，操作原来要访问的就是这个对象；<br/>
        第二个参数是一个配置对象，对于每一个被代理的操作，需要提供一个对应的处理函数，该函数将拦截对应的操作。
        <br/>get方法的两个参数分别是目标对象和所要访问的属性。
    </p>
    <p>
        注意，要使得Proxy起作用，必须针对Proxy实例（上例是proxy对象）进行操作，而不是针对目标对象（上例是空对象）进行操作。
    </p>
    <p>
        如果handler没有设置任何拦截，那就等同于直接通向原对象。
    </p>
    <pre>
        var target = {};
        var handler = {};

        var proxy = new Proxy(target, handler);

        proxy.a = 'b';
        target.a // "b"
    </pre>
    <h3>用途</h3>
    <p>
        通过代理原型对象来实现拦截实例对原型的访问。
    </p>
    <pre>
        let proto = new Proxy({}, {
          get(target, propertyKey, receiver) {
            console.log('GET ' + propertyKey);
            return target[propertyKey];
          }
        });

        let obj = Object.create(proto);

        obj.foo // "GET foo"
    </pre>

    <p>
        下面的例子使用get拦截，实现数组读取负数的索引
    </p>
    <pre>
        function createArray(...elements) {
          let handler = {
            get(target, propKey, receiver) {
              let index = Number(propKey);
              if (index < 0) {
                propKey = String(target.length + index);
              }
              return Reflect.get(target, propKey, receiver);
            }
          };

          let target = [];
          target.push(...elements);
          return new Proxy(target, handler);
        }

        let arr = createArray('a', 'b', 'c');
        arr[-1] // c
    </pre>
</div>
</body>
</html>